{"version":3,"sources":["webpack:///path---monads-d5fd1ddd97b87f8671f1.js","webpack:///./.cache/json/monads.json"],"names":["webpackJsonp","764","module","exports","data","site","siteMetadata","disqusShortname","siteUrlShort","siteUrl","siteTitle","siteLogo","markdownRemark","html","shortExcerpt","longExcerpt","frontmatter","date","path","title","tags","featuredImage","name","childImageSharp","sizes","src","srcSet","base64","aspectRatio","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,gBAAA,WAAAC,aAAA,wBAAAC,QAAA,gCAAAC,UAAA,iCAAAC,SAAA,uCAA4MC,gBAAmBC,KAAA;AAA6y/CC,aAAA,sEAAAC,YAAA,iZAAAC,aAAwxEC,KAAA,iBAAAC,KAAA,UAAAC,MAAA,2CAAAC,MAAA,kBAAAC,eAAuIC,KAAA,SAAAC,iBAAmCC,OAASC,IAAA,4DAAAC,OAAA,sQAAAC,OAAA,8zBAA2WC,YAAA,IAAAJ,MAAA,0CAAg3BK","file":"path---monads-d5fd1ddd97b87f8671f1.js","sourcesContent":["webpackJsonp([170358752846131],{\n\n/***/ 764:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"disqusShortname\":\"garrynsk\",\"siteUrlShort\":\"victoriaz.netlify.com\",\"siteUrl\":\"https://victoriaz.netlify.com\",\"siteTitle\":\"VictoriaZ programming sketches\",\"siteLogo\":\"/img/Flying_Herk_in_the_Clouds.svg\"}},\"markdownRemark\":{\"html\":\"<p>You’ve heard about them many times, but still not sure if you need them? Or maybe you use them every day and happy with it? In any case, you do not want to miss a chance to discuss them one more time. If it is so, let’s begin!</p>\\n<h2 id=\\\"introduction\\\"><a href=\\\"#introduction\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Introduction</h2>\\n<p>First of all I’ll remind you how they look like.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">trait</span> Monad<span class=\\\"token punctuation\\\">[</span>F<span class=\\\"token punctuation\\\">[</span>_<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">,</span> B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>fa<span class=\\\"token operator\\\">:</span> F<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> F<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> F<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n  \\n  <span class=\\\"token keyword\\\">def</span> pure<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token operator\\\">:</span> A<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> F<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>!!!Monad laws</p>\\n<p>Misterious, aren’t they?..</p>\\n<p>No, they are not! You must be hit on them several times a day. When you do like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">import</span> scala<span class=\\\"token punctuation\\\">.</span>concurrent<span class=\\\"token punctuation\\\">.</span>Future\\n<span class=\\\"token keyword\\\">import</span> scala<span class=\\\"token punctuation\\\">.</span>concurrent<span class=\\\"token punctuation\\\">.</span>ExecutionContext<span class=\\\"token punctuation\\\">.</span>Implicits<span class=\\\"token punctuation\\\">.</span>global\\n\\n<span class=\\\"token keyword\\\">def</span> queryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> nextQueryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">for</span><span class=\\\"token punctuation\\\">{</span>\\n\\n  firstResult <span class=\\\"token keyword\\\">&lt;-</span> Future<span class=\\\"token punctuation\\\">(</span>queryFromDatabase<span class=\\\"token punctuation\\\">)</span>\\n  \\n  secondResult <span class=\\\"token keyword\\\">&lt;-</span> Future<span class=\\\"token punctuation\\\">(</span>nextQueryFromDatabase<span class=\\\"token punctuation\\\">)</span>\\n  \\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token keyword\\\">yield</span><span class=\\\"token punctuation\\\">(</span>firstResult <span class=\\\"token operator\\\">:</span><span class=\\\"token operator\\\">:</span> secondResult<span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<p>Or like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\">  <span class=\\\"token keyword\\\">val</span> listFirst <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">)</span>\\n\\n  <span class=\\\"token keyword\\\">val</span> listSecond <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">5</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">6</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">7</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">8</span><span class=\\\"token punctuation\\\">)</span>\\n\\nlistFirst<span class=\\\"token punctuation\\\">.</span>flatMap<span class=\\\"token punctuation\\\">{</span> valueFirst <span class=\\\"token keyword\\\">=></span> listSecond<span class=\\\"token punctuation\\\">.</span>map <span class=\\\"token punctuation\\\">{</span> valueSecond <span class=\\\"token keyword\\\">=></span> valueFirst <span class=\\\"token operator\\\">+</span> valueSecond <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Nothing special, to be honest. But why are there generated so much buzz around them? Some people love them, some - hate them. Come on, they are simple lists, futures, options and nothing more!</p>\\n<p>Yes and no. Look here.</p>\\n<p>We can write code without monads at all. And there is nothing wrong with it, just another way to express your thoughts.</p>\\n<p>But notice, if the error occures, the program will crash and it is not a good user experience.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> queryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> nextQueryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">val</span> firstResult <span class=\\\"token operator\\\">=</span> queryFromDatabase\\n\\n<span class=\\\"token keyword\\\">val</span> secondResult <span class=\\\"token operator\\\">=</span> nextQueryFromDatabase\\n\\n<span class=\\\"token keyword\\\">val</span> result <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span> firstResult <span class=\\\"token operator\\\">!=</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span> secondResult <span class=\\\"token operator\\\">!=</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n    \\n    firstResult <span class=\\\"token operator\\\">:</span><span class=\\\"token operator\\\">:</span> secondResult\\n    \\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token keyword\\\">else</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// Attention! The program will throw an error.</span>\\n    <span class=\\\"token keyword\\\">throw</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  \\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token keyword\\\">else</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">throw</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>We can get rid of flat map in the second case too. Just loop over each of the lists and sum the numbers. </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">val</span> listFirst <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token keyword\\\">val</span> listSecond <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">5</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">6</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">7</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">8</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\">// Attention! Mutable value.</span>\\n<span class=\\\"token keyword\\\">var</span> result<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token keyword\\\">for</span><span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token keyword\\\">&lt;-</span> listFirst<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">for</span><span class=\\\"token punctuation\\\">(</span>j <span class=\\\"token keyword\\\">&lt;-</span> listSecond<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">+</span> j<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span><span class=\\\"token operator\\\">:</span>result\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Now it is hard to reason about the code. Somebody can change the state of the variable unintentionally, for example, on an another thread, and we will get a wrong result.</p>\\n<p>So, what do you think? It seems pretty obvious, that flatMap is a more consice and clever way to code. Is that all? Just a clear syntax? No, it isn’t.</p>\\n<p>Let’s elaborate. In both cases we had to use some unsafe technique: throw an error or use a mutable value. And a monad helped us to eliminate this. A monad can modify the value, isolating it from outside world in a container.</p>\\n<p>There are quite a few problems we can solve with monads. I won’t list them myself, but I will cite Bartosz Milewski’s great <a href=\\\"https://bartoszmilewski.com/2016/11/30/monads-and-effects/\\\">article</a>:</p>\\n<blockquote>\\n<p>Here is a short list of similar problems, copied from <a href=\\\"https://core.ac.uk/download/pdf/21173011.pdf\\\">Eugenio Moggi’s seminal paper</a>, all of which are traditionally solved by abandoning the purity of functions.</p>\\n<ol>\\n<li>Partiality: Computations that may not terminate</li>\\n<li>Nondeterminism: Computations that may return many results</li>\\n<li>Side effects: Computations that access/modify state\\na. Read-only state, or the environment\\nb. Write-only state, or a log\\nc. Read/write state</li>\\n<li>Exceptions: Partial functions that may fail</li>\\n<li>Continuations: Ability to save state of the program and then restore it on demand</li>\\n<li>Interactive Input</li>\\n<li>Interactive Output</li>\\n</ol>\\n<p>What really is mind blowing is that all these problems may be solved using the same clever trick: turning to embellished functions <em>(monads, mine note)</em>.</p>\\n</blockquote>\\n<p>Thus, we can solve several important problems in two ways. Traditional one is cumbersome and unsafe. Monadic one respects explicitness and clarity. </p>\\n<p>More on the problems you can avoid with monads you can read in <a href=\\\"https://philipnilsson.github.io/Badness10k/escaping-hell-with-monads/\\\">“Escaping Hell with Monads”</a>.</p>\\n<p>So, which approach to choose? Hey, take both!</p>\\n<p>Seriously, you don’t have to give up one thing for another. I belive so. Think different. We must understand when to go which way. Understanding will help up to see clearly rather than roam blindly between functional and imperative worlds.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-029df.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 44.38888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz31RS0sCURT2t/QLok20qB8QQW0jCgIXFbaJWrWIWrioyCJIehhFD8pCikAXaWb4nApTK8vJfEaNOo4zo+O87ti9TlEhdDhcvnP4vnPPQ1P71xQFNIb5xDFL2CHQNPLrDnnIVADfNO6nixmVEfNNRt1TP2IAwBf9l6BUJGMRL4pqtaOVkaDnECapjCXr7crg7j8/qwKqQJDEGwQpPLi/OLRrGGZo6uZi7WyjnyzkxUr25byZCXW8hycS0VMkFgU+4LRyXKVE5tZntH67OYlH5nTNts0BmsrhD74dfVvI1hv27ckSd+c2xt19ych6/NGKxFuG6dHulgQsZZqd6Gm6uTrFnOaFsfal8dYIZrvHDnfnu2xbg9eXpnzWn8Z0r65OOr2N2oaDmTeXD1bnckQWc51YTPpkLPQcctx6ThyWhUz89iPlLxIvQZex8P7E5gPFlJljEumAtsqxGjgqzwu8KMFKXJWrCgLan6KwlUqVF2sKkIFS5kSapsplFnF4qVRiGJqURAG1DWQZuroztPY6kOum3laWJZgGQPmmfB3/Ewae17J+UWzJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"functional\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-fb8a0.png\\\"\\n        srcset=\\\"/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-1a291.png 148w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-2bc4a.png 295w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-fb8a0.png 590w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-526de.png 885w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-fa2eb.png 1180w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-08f6a.png 1770w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-029df.png 1800w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2 id=\\\"its-all-about-pure-functons\\\"><a href=\\\"#its-all-about-pure-functons\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>It’s all about… pure functons?</h2>\\n<p>Now we know that monads can magically rewrite functions into powerfull constructions, which eliminate almost all issues with plain functions. But which properties allow them to do it?</p>\\n<p>Ok, first of all, list some of these issues, which can be a real pain in the ass, one more time:</p>\\n<ol>\\n<li>Functions can fail.</li>\\n<li>The value may be uncertain, when we are not sure if it exists at all.</li>\\n<li>The value can depend on a shared state.</li>\\n<li>Functions can produce effects.</li>\\n<li>Functions can be asyncronous, when the value exists in the future.</li>\\n<li>The function result can vary for the same input.</li>\\n</ol>\\n<p>What are common characteristics you see? We can’t reason about the result for sure. We need to know the state of the whole application to do it. You can never know how your program actually works. It is bad, it is very bad. </p>\\n<p>Can we invert this description? We want to be sure how the program works. We want to work with a part of an application in isolation to test it. We want to know, that every time, the function receives a result, it produces the same output. As you probably know, it is the definition of a pure function, which is ubiquitous in a functional programming.</p>\\n<p>I won’t write about what functional programming is, you can read it in <a href=\\\"https://maryrosecook.com/blog/post/a-practical-introduction-to-functional-programming\\\">“A practical introduction to functional programming”</a> by Mary Rose Cook. We will talk about less discussed topic: what’s the purpose of the pure functions and functional programming in general. </p>\\n<p>Some say it is just a matter of style. If you think like that, then I strongly advise you to stop reading this nonsence and verify if you know all words from <a href=\\\"https://github.com/hemanth/functional-programming-jargon\\\">here</a>. But if you love digging deeper, then follow me.</p>\\n<p>Since pure functions are tightly coupled with side effects, I’ll better explain what a side effect is.</p>\\n<div class=\\\"reddit-embed\\\" data-embed-media=\\\"www.redditmedia.com\\\" data-embed-parent=\\\"false\\\" data-embed-live=\\\"false\\\" data-embed-uuid=\\\"78f29787-e078-4498-9f85-c0151a78eaac\\\" data-embed-created=\\\"2018-03-24T17:13:10.619Z\\\"><a href=\\\"https://www.reddit.com/r/scala/comments/2898l1/functional_programming_what_are_side_effects/ci8p0bi/\\\">Comment</a> from discussion <a href=\\\"https://www.reddit.com/r/scala/comments/2898l1/functional_programming_what_are_side_effects/\\\">Functional Programming : What are side effects?</a>.</div>\\n<p>From the <a href=\\\"https://en.wikipedia.org/w/index.php?title=Side_effect_(computer_science)\\\">Side effect (computer science) - Wikipedia</a>:</p>\\n<blockquote>\\n<p>Absence of side effects is a necessary, but not sufficient, condition for referential transparency. Referential transparency means that an expression (such as a function call) can be replaced with its value; this requires that the expression has no side effects and is pure (always returns the same results on the same input). A function without side effects may be impure, for example if its output depends on the value of a global variable.</p>\\n</blockquote>\\n<p>For example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token comment\\\">// referential transparent function</span>\\n<span class=\\\"token keyword\\\">def</span> sum<span class=\\\"token punctuation\\\">(</span>a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">,</span> b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span> <span class=\\\"token punctuation\\\">{</span>\\n  a <span class=\\\"token operator\\\">+</span> b\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nsum<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token comment\\\">// true</span>\\n\\n<span class=\\\"token comment\\\">// function with side effect</span>\\n<span class=\\\"token keyword\\\">def</span> sumIO<span class=\\\"token punctuation\\\">(</span>a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">,</span> b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Unit</span> <span class=\\\"token punctuation\\\">{</span>\\n  println<span class=\\\"token punctuation\\\">(</span>a <span class=\\\"token operator\\\">+</span> b<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nsumIO<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// false </span>\\n</code></pre>\\n      </div>\\n<p>Thus, <span class=\\\"underline\\\"> a pure function can be with or without side effects </span>, but <a href=\\\"https://en.wikipedia.org/wiki/Pure_function\\\">evaluation of the result does not cause any semantically observable side effect or output, such as mutation of mutable objects or output to I/O devices</a>. For example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> pureFunction<span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">val</span> y <span class=\\\"token operator\\\">=</span> Math<span class=\\\"token punctuation\\\">.</span>rand<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n  \\n  x\\n<span class=\\\"token punctuation\\\">}</span>\\n\\npureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// always 2</span>\\n</code></pre>\\n      </div>\\n<p>And <span  class=\\\"underline\\\"> a function without side effects can be impure.</span> For example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">var</span> x <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">3</span>\\n\\n<span class=\\\"token keyword\\\">def</span> impureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n  x\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nimpureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// 3</span>\\n\\nx <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span>\\n\\nimpureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// 4</span>\\n</code></pre>\\n      </div>\\n<p>Functions with I/O operations still can be pure. And here we hit into monads. IO monads, to be precise. In Haskell side-effects don’t actually execute, they return values instead. In Scala it is not so, as Scala doesn’t support lazy evaluation by default. But we can emulate this behaviour ourself easily. We have to implement effectful function in such a way that it returns result, which can substitute the function itself.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token comment\\\">// IO monad</span>\\n<span class=\\\"token keyword\\\">trait</span> IO<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token keyword\\\">self</span> <span class=\\\"token keyword\\\">=></span>\\n\\n  <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> \\n\\n  <span class=\\\"token keyword\\\">def</span> map<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> B<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> \\n      IO<span class=\\\"token punctuation\\\">{</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">self</span><span class=\\\"token punctuation\\\">.</span>pure<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> pure<span class=\\\"token operator\\\">:</span> A\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">object</span> IO<span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token comment\\\">// f - is a function with effects</span>\\n  <span class=\\\"token keyword\\\">def</span> apply<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> A<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> \\n    <span class=\\\"token keyword\\\">new</span> IO<span class=\\\"token punctuation\\\">{</span>\\n    \\n      <span class=\\\"token comment\\\">// We do not actually execute effectful functions, </span>\\n      <span class=\\\"token comment\\\">// we compose them instead</span>\\n      <span class=\\\"token keyword\\\">override</span> <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>g<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n        IO<span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> g<span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>pure<span class=\\\"token punctuation\\\">}</span>\\n      \\n      <span class=\\\"token comment\\\">// Actual execution</span>\\n      <span class=\\\"token keyword\\\">override</span> <span class=\\\"token keyword\\\">def</span> pure<span class=\\\"token operator\\\">:</span> A <span class=\\\"token operator\\\">=</span> \\n        f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">// Now the funtion is referential transparent</span>\\n<span class=\\\"token keyword\\\">def</span> sum<span class=\\\"token punctuation\\\">(</span>a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">,</span> b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  IO<span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> println<span class=\\\"token punctuation\\\">(</span>a <span class=\\\"token operator\\\">+</span> b<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> a <span class=\\\"token operator\\\">+</span> b<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nsum<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>flatMap<span class=\\\"token punctuation\\\">(</span>a <span class=\\\"token keyword\\\">=></span> IO<span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> a <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// returns IO{() => println(3); 6}</span>\\n</code></pre>\\n      </div>\\n<p>It may seem, that all monads must be pure, as such is in Haskell. Be careful. Take into consideration that nothing is obvious in Scala. For example, Option is a monad and in Scala it is implemented something like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">sealed</span> <span class=\\\"token keyword\\\">abstract</span> <span class=\\\"token keyword\\\">class</span> Option<span class=\\\"token punctuation\\\">[</span><span class=\\\"token operator\\\">+</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">def</span> get<span class=\\\"token operator\\\">:</span> A\\n\\n  <span class=\\\"token keyword\\\">def</span> map<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> B<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Option<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>isEmpty<span class=\\\"token punctuation\\\">)</span> None <span class=\\\"token keyword\\\">else</span> Some<span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>get<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> Option<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Option<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>isEmpty<span class=\\\"token punctuation\\\">)</span> None <span class=\\\"token keyword\\\">else</span> f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>get<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">object</span> Option <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> apply<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token operator\\\">:</span> A<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Option<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> \\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">==</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span> None <span class=\\\"token keyword\\\">else</span> Some<span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token punctuation\\\">)</span>\\n    \\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">case</span> <span class=\\\"token keyword\\\">class</span> Some<span class=\\\"token punctuation\\\">[</span><span class=\\\"token operator\\\">+</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>value<span class=\\\"token operator\\\">:</span> A<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">extends</span> Option<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">def</span> get <span class=\\\"token operator\\\">=</span> value\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">case</span> <span class=\\\"token keyword\\\">object</span> None <span class=\\\"token keyword\\\">extends</span> Option<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Nothing</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">def</span> get <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> NoSuchElementException<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"None.get\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>See anything misleading? Look at flatMap attentively. It is not lazy, it executes. What does it mean? That we can’t safely implement effectful operations with it. And if you type Option(println(4)), 4 will be outputed to the console.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\">Option<span class=\\\"token punctuation\\\">(</span>println<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// prints 4</span>\\n</code></pre>\\n      </div>\\n<p>Same with Future, List, Try and other monads in Scala. So, <span  class=\\\"underline\\\"> while monads in scala still abide monad laws, they can’t be considered pure. </span> So, functional programming is about pure functions and side effects, but monads are completely orthogonal concepts.</p>\\n<p>So, while monads are not about purity, they still can help us with the issues we listed in the beginning of the section.</p>\\n<ol>\\n<li>Functions can fail. - Option/Try/Either monad.</li>\\n<li>The value may be uncertain, when we are not sure if it exists at all. - Maybe monad.</li>\\n<li>The value can depend on a shared state. - State monad.</li>\\n<li>Functions can produce effects. - IO monad.</li>\\n<li>Functions can be asyncronous, when the value exists in the future. - Future/Promise monad.</li>\\n<li>The function result can vary for the same input. - Random monad.</li>\\n<li>The value may exists, but there are more than one of them. - List monad.</li>\\n</ol>\\n<p>!!!We have to compose and it is hard.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-c86e7.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 128.85496183206106%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAAGM0lEQVRIx4VVeXAb5RVfH3EosRNs67Rk3bva9a52V97VrdWuDkuWLVlO7NgktmTZieMjuDmMUxpIINAkJUAgwHBfw9DCcAyEmiYlDFeP6bTTGSZkuKbtDGVarjCdCRMCxtardn20HmD6/nk/ve+9n973jm+Rgwf3IccPTSKy3HtsWn380ETLzw+Or0d+QAAAibclFDy9KbNinxnY/F+nnQMbkXq1DXnt6Vsrr58Zctz+s12DJ24aJz4498r6D8/OYkmJ1R+58YbdxdE97WX3tXLM3snJaiQ2qMTfMTWmaDEqLv6jLM01tRXLWJa5r/591bvn/vXekZuOXTx03a7Pjxw+Cm5/4rPeoRHqfzMudKTosqp485e/WDQUR/J1V89MBWSsWremUtbvnzt79I3TJ6Gnux9ctA9+Oj0GwQC/sEGtA78gXbxqYnL20bvvzPVmu4o9XlYmRLCG2mrJy1cuknamnrxmoC8k4wfvenz34w8/WvJ64wtSfMu3KIqWNnXnFmJSvMQL8ZLaQkK0rQPyff2QyXTNuVr5l1C8ZXBVoXNS9ER7IAzBeHtvOpXbQbvwT1w0DzTtmacoZ2lzRxoGk5lSUEqCEM0vOLHA1w0NjfOhQOidFoYFs93xz5ggPOAjsLhC2NOdPYHarBAQhY+zmc7TdoseYiI3R6DN4LAbIOJnS+lEDFy8r+TnAiUWo8GFOkCnM35hK2vWTY9FSIJhUGtCbkrVxs7IW9ZmFWze1FaaGB8GzGG+wHGsTwx5H/K4ndDK4gt4C7bQqNUDQbPQXyjuD/q8J8kWDDAcvcCwjG3lui//6s46l9PyBaZrhCtzkW+HCz3lRrScLx/VyufJqPcpvfYKUKnq54wWC9jt1mOy3edGa1tw+5FwiO+Uf3Oks4q2myvlDNf6WOJ9n8MEdnXdHM85gaWdLy4N8VqCwJ7DUBOQFDFPtXJgstoGliZ8JSmHw1oha2qx4Qhy9MD0Y33pCBg1Gy4FfSRk20LPyvb7HpzVF4Z2ft4W9YDG6J23knHAaQGC0YQ84IiLpte4XHjlMrEoicvr9DU1vLX7S542AoEZSyyNQ8CH4wMDxbFtha0wmN8yv0HHQW29e67ZIQDjCz8jx9kJulKMRxWOcGApu21b01WyPjA92p+JuUCjagBDk/6iEOLD+SuzL7tIB2Ake8lGhC/WN5jnUUoEC0a+IcdcrrFXCNHo6mXvTSlLgkxs9K8TefJDk6HcSYvxeLl+NVKo9SNHeSxwmv1IrTH/AXOgwAdiEBaF38sxOoutopUPrSYsZKQVnAwwp0jMBCyD3SLvdbZd/Hsw4AaG4/ZSFN2/fbhwAcMp8ArSKdl/7eXrK7/zHHVyNDI6kFWuPZnPHW0TebisBukdH9v1Y8qdAhfLAUFYpbHJicZ0wvMnOePaBuY9FO+sl2P0JqHiO6QTI70K4dVTha7uTHSuPeklhoe2/9aO+cFkI2bls1RHn/GK+sYLGp0ZTA7pUxMa1C4S8qsJcz4GEcOcggM8rcmmxdF9eyf3by8WgXYx0GT2/6OmTqjrzm46pFJR4CQ4cDj5m5fGpuqHHuLyRggreP/01OmRQg60WhtodYFP3YxHZzPb3mlqxKDZQADFWJVOOAm0XEPn9xOObulTUjdVVdVPbMufj0TD0KzFwKRlZ5SONqheZWwU4KT/G62D8sg2SwtXGZaS3/+d8HGU0rGR/JaBrq4USFIc3Hjgba+qbp0yxHq1JxGULkWkLNBhUfmo8GK7cmV1U3w14ZtnTi4TV9x43b4/RiURfHzsr3ccvtuw7PP8c/drcvHIeZZkIdMzfFy22ZyeNQTTo5zrLcFFx9+cegG5Zs+Igs/++a7q3eNDfxGCMfCLuSdkmxBM1Mh6arw/2xEPgBNHS5wv9sm6avPKk6U1RVZnKEaCSv38ftKQTqb/1trqhqAY+fXSsVKK0eLm2VSbABpNA9gIF9jJ6Fcb1O4p3C39SKmx2b+c4Ulk5/hItYyv/cnU4eLQOKCMAEIi9brBYKpZKkWV18MWPTz9gLHZcA/Beu5t68m/1Iy1/s5GelOyT5OdXZzHM2dOITdcu0fJ4qF7bsvs2DHyCCskZ24+cbvywE7OHED+r6zBV+B/AClfC6u+Ve2lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"Transformer\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-fb8a0.png\\\"\\n        srcset=\\\"/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-1a291.png 148w,\\n/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-2bc4a.png 295w,\\n/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-fb8a0.png 590w,\\n/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-c86e7.png 655w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2 id=\\\"monad-transformers\\\"><a href=\\\"#monad-transformers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Monad Transformers</h2>\\n<p>Again, I won’t explain, what monad transformers are. You can find answers in a nice article <a href=\\\"https://blog.buildo.io/monad-transformers-for-the-working-programmer-aa7e981190e7\\\">Monad Transformers for the working programmer</a> by Gabriele Petronella.</p>\\n<p>The main inference from it is that <a href=\\\"http://blog.tmorris.net/posts/monads-do-not-compose/\\\">monads do not compose</a>. For their composition you need monad transformers. Example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>User<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n<span class=\\\"token keyword\\\">def</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token operator\\\">:</span> User<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> findOrderByUserID<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">{</span>\\n    user    <span class=\\\"token keyword\\\">&lt;-</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span>\\n    order <span class=\\\"token keyword\\\">&lt;-</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">yield</span> order\\n  \\n</code></pre>\\n      </div>\\n<p>What if we don’t know if we have any orders?</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>User<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n<span class=\\\"token keyword\\\">def</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token operator\\\">:</span> User<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Option<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> findOrderByUserID<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">{</span>\\n    user  <span class=\\\"token keyword\\\">&lt;-</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// Future[User]</span>\\n    order <span class=\\\"token keyword\\\">&lt;-</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// Future[Option[Order]]</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">yield</span> order\\n  \\n<span class=\\\"token comment\\\">// Type error. Nothing like we expected.</span>\\n</code></pre>\\n      </div>\\n<p>But we can use a monad transformer! </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">import</span> cats<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">.</span>OptionT<span class=\\\"token punctuation\\\">,</span> cats<span class=\\\"token punctuation\\\">.</span>std<span class=\\\"token punctuation\\\">.</span>future<span class=\\\"token punctuation\\\">.</span>_\\n<span class=\\\"token keyword\\\">def</span> findOrderByUserID<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Option<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n  <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">{</span>\\n    user    <span class=\\\"token keyword\\\">&lt;-</span> OptionT<span class=\\\"token punctuation\\\">(</span>getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n    order <span class=\\\"token keyword\\\">&lt;-</span> OptionT<span class=\\\"token punctuation\\\">(</span>getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">yield</span> order<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>value\\n</code></pre>\\n      </div>\\n<p>Great, now we are safe! Heh, not even close. When you enter the world of monad transformers, there is no way back. There exists a whole <a href=\\\"http://github.com/haskell/mtl/tree/master/Control/Monad\\\">“mtl” library</a> for them in Haskell. Haven’t seen anything like that in Scala though. And John A De Goes wrote a great article, which named <a href=\\\"http://degoes.net/articles/only-one-io\\\">There Can Be Only One…IO Monad</a>, leverage issues which occure, when we need to compose several monads together. </p>\\n<p>So, monad transformers are, literally, just monads wrapping other monads, which help us to compose monads. Nothing more.</p>\\n<p>!!! Problems with mtl: effects when combine monads, many monads.</p>\\n<p>Due to several problems, which accompany monad transformers, people introduced other approaches, such as Eff monad <a href=\\\"ttps://rubenpieters.github.io/monadtransformer/cats/eff/2017/01/27/monadtransformer-vs-effmonad-1.html\\\">“From Monad Transformers to the Eff Monad”</a>, Extensible effects <a href=\\\"https://www.cs.indiana.edu/~sabry/papers/exteff.pdf\\\">“Extensible Effects An Alternative to Monad Transformers”</a> by Oleg Kiselyov, Algebraic effects <a href=\\\"http://www.eff-lang.org/handlers-tutorial.pdf\\\">An Introduction to Algebraic Effects and Handlers</a>.</p>\\n<p>!!!When we compose, it is overhead, because we can’t use fusion.\\n!!! All of the problems can be solved in an imperative approach.\\nJavaScript leverage it’s single thread model to write in an imperative style</p>\\n<p>So, it is necessarily to write in monadic style? No. Can we write it in imperative way? Yes. </p>\\n<p>clumsy</p>\",\"shortExcerpt\":\"You’ve heard about them many times, but still not sure if you need…\",\"longExcerpt\":\"You’ve heard about them many times, but still not sure if you need them? Or maybe you use them every day and happy with it? In any case, you do not want to miss a chance to discuss them one more time. If it is so, let’s begin! Introduction First of all I’ll remind you how they look like. !!!Monad laws Misterious, aren’t they?.. No, they are not! You must be hit on them several times a day. When…\",\"frontmatter\":{\"date\":\"March 26, 2018\",\"path\":\"/monads\",\"title\":\"What are they, monads, angels or demons?\",\"tags\":[\"monads\",\"Scala\"],\"featuredImage\":{\"name\":\"angels\",\"childImageSharp\":{\"sizes\":{\"src\":\"/static/angels-2f707442fd003e1bc4d79ed77236a895-d447e.jpg\",\"srcSet\":\"/static/angels-2f707442fd003e1bc4d79ed77236a895-eed67.jpg 475w,\\n/static/angels-2f707442fd003e1bc4d79ed77236a895-f26f9.jpg 950w,\\n/static/angels-2f707442fd003e1bc4d79ed77236a895-d447e.jpg 1900w,\\n/static/angels-2f707442fd003e1bc4d79ed77236a895-3d50f.jpg 1920w\",\"base64\":\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAapMkaolf//EABoQAQACAwEAAAAAAAAAAAAAAAIBAwAREiH/2gAIAQEAAQUCrr4rcR2gMra0nKx+T//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAABESICECH/2gAIAQEABj8CqRkiqQ+kPX//xAAaEAEAAwADAAAAAAAAAAAAAAABABEhQVFh/9oACAEBAAE/IRyjm+xIGFXrLRTK6lQjn+JpJ//aAAwDAQACAAMAAAAQ7x//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8Qra//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QjI//xAAbEAEBAAMAAwAAAAAAAAAAAAABEQAhMVFhcf/aAAgBAQABPxBMH0+SxaAAEle3OWC5V94ShHXzJkSQGbMVpoNXP//Z\",\"aspectRatio\":1.5,\"sizes\":\"(max-width: 1900px) 100vw, 1900px\"}}}}}},\"pathContext\":{}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---monads-d5fd1ddd97b87f8671f1.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"disqusShortname\":\"garrynsk\",\"siteUrlShort\":\"victoriaz.netlify.com\",\"siteUrl\":\"https://victoriaz.netlify.com\",\"siteTitle\":\"VictoriaZ programming sketches\",\"siteLogo\":\"/img/Flying_Herk_in_the_Clouds.svg\"}},\"markdownRemark\":{\"html\":\"<p>You’ve heard about them many times, but still not sure if you need them? Or maybe you use them every day and happy with it? In any case, you do not want to miss a chance to discuss them one more time. If it is so, let’s begin!</p>\\n<h2 id=\\\"introduction\\\"><a href=\\\"#introduction\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Introduction</h2>\\n<p>First of all I’ll remind you how they look like.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">trait</span> Monad<span class=\\\"token punctuation\\\">[</span>F<span class=\\\"token punctuation\\\">[</span>_<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">,</span> B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>fa<span class=\\\"token operator\\\">:</span> F<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> F<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> F<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n  \\n  <span class=\\\"token keyword\\\">def</span> pure<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token operator\\\">:</span> A<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> F<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>!!!Monad laws</p>\\n<p>Misterious, aren’t they?..</p>\\n<p>No, they are not! You must be hit on them several times a day. When you do like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">import</span> scala<span class=\\\"token punctuation\\\">.</span>concurrent<span class=\\\"token punctuation\\\">.</span>Future\\n<span class=\\\"token keyword\\\">import</span> scala<span class=\\\"token punctuation\\\">.</span>concurrent<span class=\\\"token punctuation\\\">.</span>ExecutionContext<span class=\\\"token punctuation\\\">.</span>Implicits<span class=\\\"token punctuation\\\">.</span>global\\n\\n<span class=\\\"token keyword\\\">def</span> queryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> nextQueryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">for</span><span class=\\\"token punctuation\\\">{</span>\\n\\n  firstResult <span class=\\\"token keyword\\\">&lt;-</span> Future<span class=\\\"token punctuation\\\">(</span>queryFromDatabase<span class=\\\"token punctuation\\\">)</span>\\n  \\n  secondResult <span class=\\\"token keyword\\\">&lt;-</span> Future<span class=\\\"token punctuation\\\">(</span>nextQueryFromDatabase<span class=\\\"token punctuation\\\">)</span>\\n  \\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token keyword\\\">yield</span><span class=\\\"token punctuation\\\">(</span>firstResult <span class=\\\"token operator\\\">:</span><span class=\\\"token operator\\\">:</span> secondResult<span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<p>Or like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\">  <span class=\\\"token keyword\\\">val</span> listFirst <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">)</span>\\n\\n  <span class=\\\"token keyword\\\">val</span> listSecond <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">5</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">6</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">7</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">8</span><span class=\\\"token punctuation\\\">)</span>\\n\\nlistFirst<span class=\\\"token punctuation\\\">.</span>flatMap<span class=\\\"token punctuation\\\">{</span> valueFirst <span class=\\\"token keyword\\\">=></span> listSecond<span class=\\\"token punctuation\\\">.</span>map <span class=\\\"token punctuation\\\">{</span> valueSecond <span class=\\\"token keyword\\\">=></span> valueFirst <span class=\\\"token operator\\\">+</span> valueSecond <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Nothing special, to be honest. But why are there generated so much buzz around them? Some people love them, some - hate them. Come on, they are simple lists, futures, options and nothing more!</p>\\n<p>Yes and no. Look here.</p>\\n<p>We can write code without monads at all. And there is nothing wrong with it, just another way to express your thoughts.</p>\\n<p>But notice, if the error occures, the program will crash and it is not a good user experience.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> queryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> nextQueryFromDatabase<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">val</span> firstResult <span class=\\\"token operator\\\">=</span> queryFromDatabase\\n\\n<span class=\\\"token keyword\\\">val</span> secondResult <span class=\\\"token operator\\\">=</span> nextQueryFromDatabase\\n\\n<span class=\\\"token keyword\\\">val</span> result <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span> firstResult <span class=\\\"token operator\\\">!=</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span> secondResult <span class=\\\"token operator\\\">!=</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n    \\n    firstResult <span class=\\\"token operator\\\">:</span><span class=\\\"token operator\\\">:</span> secondResult\\n    \\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token keyword\\\">else</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// Attention! The program will throw an error.</span>\\n    <span class=\\\"token keyword\\\">throw</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  \\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token keyword\\\">else</span><span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">throw</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>We can get rid of flat map in the second case too. Just loop over each of the lists and sum the numbers. </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">val</span> listFirst <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token keyword\\\">val</span> listSecond <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">5</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">6</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">7</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">8</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\">// Attention! Mutable value.</span>\\n<span class=\\\"token keyword\\\">var</span> result<span class=\\\"token operator\\\">:</span> List<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> List<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token keyword\\\">for</span><span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token keyword\\\">&lt;-</span> listFirst<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">for</span><span class=\\\"token punctuation\\\">(</span>j <span class=\\\"token keyword\\\">&lt;-</span> listSecond<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">+</span> j<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span><span class=\\\"token operator\\\">:</span>result\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Now it is hard to reason about the code. Somebody can change the state of the variable unintentionally, for example, on an another thread, and we will get a wrong result.</p>\\n<p>So, what do you think? It seems pretty obvious, that flatMap is a more consice and clever way to code. Is that all? Just a clear syntax? No, it isn’t.</p>\\n<p>Let’s elaborate. In both cases we had to use some unsafe technique: throw an error or use a mutable value. And a monad helped us to eliminate this. A monad can modify the value, isolating it from outside world in a container.</p>\\n<p>There are quite a few problems we can solve with monads. I won’t list them myself, but I will cite Bartosz Milewski’s great <a href=\\\"https://bartoszmilewski.com/2016/11/30/monads-and-effects/\\\">article</a>:</p>\\n<blockquote>\\n<p>Here is a short list of similar problems, copied from <a href=\\\"https://core.ac.uk/download/pdf/21173011.pdf\\\">Eugenio Moggi’s seminal paper</a>, all of which are traditionally solved by abandoning the purity of functions.</p>\\n<ol>\\n<li>Partiality: Computations that may not terminate</li>\\n<li>Nondeterminism: Computations that may return many results</li>\\n<li>Side effects: Computations that access/modify state\\na. Read-only state, or the environment\\nb. Write-only state, or a log\\nc. Read/write state</li>\\n<li>Exceptions: Partial functions that may fail</li>\\n<li>Continuations: Ability to save state of the program and then restore it on demand</li>\\n<li>Interactive Input</li>\\n<li>Interactive Output</li>\\n</ol>\\n<p>What really is mind blowing is that all these problems may be solved using the same clever trick: turning to embellished functions <em>(monads, mine note)</em>.</p>\\n</blockquote>\\n<p>Thus, we can solve several important problems in two ways. Traditional one is cumbersome and unsafe. Monadic one respects explicitness and clarity. </p>\\n<p>More on the problems you can avoid with monads you can read in <a href=\\\"https://philipnilsson.github.io/Badness10k/escaping-hell-with-monads/\\\">“Escaping Hell with Monads”</a>.</p>\\n<p>So, which approach to choose? Hey, take both!</p>\\n<p>Seriously, you don’t have to give up one thing for another. I belive so. Think different. We must understand when to go which way. Understanding will help up to see clearly rather than roam blindly between functional and imperative worlds.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-029df.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 44.38888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz31RS0sCURT2t/QLok20qB8QQW0jCgIXFbaJWrWIWrioyCJIehhFD8pCikAXaWb4nApTK8vJfEaNOo4zo+O87ti9TlEhdDhcvnP4vnPPQ1P71xQFNIb5xDFL2CHQNPLrDnnIVADfNO6nixmVEfNNRt1TP2IAwBf9l6BUJGMRL4pqtaOVkaDnECapjCXr7crg7j8/qwKqQJDEGwQpPLi/OLRrGGZo6uZi7WyjnyzkxUr25byZCXW8hycS0VMkFgU+4LRyXKVE5tZntH67OYlH5nTNts0BmsrhD74dfVvI1hv27ckSd+c2xt19ych6/NGKxFuG6dHulgQsZZqd6Gm6uTrFnOaFsfal8dYIZrvHDnfnu2xbg9eXpnzWn8Z0r65OOr2N2oaDmTeXD1bnckQWc51YTPpkLPQcctx6ThyWhUz89iPlLxIvQZex8P7E5gPFlJljEumAtsqxGjgqzwu8KMFKXJWrCgLan6KwlUqVF2sKkIFS5kSapsplFnF4qVRiGJqURAG1DWQZuroztPY6kOum3laWJZgGQPmmfB3/Ewae17J+UWzJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"functional\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-fb8a0.png\\\"\\n        srcset=\\\"/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-1a291.png 148w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-2bc4a.png 295w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-fb8a0.png 590w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-526de.png 885w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-fa2eb.png 1180w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-08f6a.png 1770w,\\n/static/functional-0658e1a27cd5ed6572b01f4f4d6bf90c-029df.png 1800w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2 id=\\\"its-all-about-pure-functons\\\"><a href=\\\"#its-all-about-pure-functons\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>It’s all about… pure functons?</h2>\\n<p>Now we know that monads can magically rewrite functions into powerfull constructions, which eliminate almost all issues with plain functions. But which properties allow them to do it?</p>\\n<p>Ok, first of all, list some of these issues, which can be a real pain in the ass, one more time:</p>\\n<ol>\\n<li>Functions can fail.</li>\\n<li>The value may be uncertain, when we are not sure if it exists at all.</li>\\n<li>The value can depend on a shared state.</li>\\n<li>Functions can produce effects.</li>\\n<li>Functions can be asyncronous, when the value exists in the future.</li>\\n<li>The function result can vary for the same input.</li>\\n</ol>\\n<p>What are common characteristics you see? We can’t reason about the result for sure. We need to know the state of the whole application to do it. You can never know how your program actually works. It is bad, it is very bad. </p>\\n<p>Can we invert this description? We want to be sure how the program works. We want to work with a part of an application in isolation to test it. We want to know, that every time, the function receives a result, it produces the same output. As you probably know, it is the definition of a pure function, which is ubiquitous in a functional programming.</p>\\n<p>I won’t write about what functional programming is, you can read it in <a href=\\\"https://maryrosecook.com/blog/post/a-practical-introduction-to-functional-programming\\\">“A practical introduction to functional programming”</a> by Mary Rose Cook. We will talk about less discussed topic: what’s the purpose of the pure functions and functional programming in general. </p>\\n<p>Some say it is just a matter of style. If you think like that, then I strongly advise you to stop reading this nonsence and verify if you know all words from <a href=\\\"https://github.com/hemanth/functional-programming-jargon\\\">here</a>. But if you love digging deeper, then follow me.</p>\\n<p>Since pure functions are tightly coupled with side effects, I’ll better explain what a side effect is.</p>\\n<div class=\\\"reddit-embed\\\" data-embed-media=\\\"www.redditmedia.com\\\" data-embed-parent=\\\"false\\\" data-embed-live=\\\"false\\\" data-embed-uuid=\\\"78f29787-e078-4498-9f85-c0151a78eaac\\\" data-embed-created=\\\"2018-03-24T17:13:10.619Z\\\"><a href=\\\"https://www.reddit.com/r/scala/comments/2898l1/functional_programming_what_are_side_effects/ci8p0bi/\\\">Comment</a> from discussion <a href=\\\"https://www.reddit.com/r/scala/comments/2898l1/functional_programming_what_are_side_effects/\\\">Functional Programming : What are side effects?</a>.</div>\\n<p>From the <a href=\\\"https://en.wikipedia.org/w/index.php?title=Side_effect_(computer_science)\\\">Side effect (computer science) - Wikipedia</a>:</p>\\n<blockquote>\\n<p>Absence of side effects is a necessary, but not sufficient, condition for referential transparency. Referential transparency means that an expression (such as a function call) can be replaced with its value; this requires that the expression has no side effects and is pure (always returns the same results on the same input). A function without side effects may be impure, for example if its output depends on the value of a global variable.</p>\\n</blockquote>\\n<p>For example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token comment\\\">// referential transparent function</span>\\n<span class=\\\"token keyword\\\">def</span> sum<span class=\\\"token punctuation\\\">(</span>a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">,</span> b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span> <span class=\\\"token punctuation\\\">{</span>\\n  a <span class=\\\"token operator\\\">+</span> b\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nsum<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token comment\\\">// true</span>\\n\\n<span class=\\\"token comment\\\">// function with side effect</span>\\n<span class=\\\"token keyword\\\">def</span> sumIO<span class=\\\"token punctuation\\\">(</span>a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">,</span> b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Unit</span> <span class=\\\"token punctuation\\\">{</span>\\n  println<span class=\\\"token punctuation\\\">(</span>a <span class=\\\"token operator\\\">+</span> b<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nsumIO<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// false </span>\\n</code></pre>\\n      </div>\\n<p>Thus, <span class=\\\"underline\\\"> a pure function can be with or without side effects </span>, but <a href=\\\"https://en.wikipedia.org/wiki/Pure_function\\\">evaluation of the result does not cause any semantically observable side effect or output, such as mutation of mutable objects or output to I/O devices</a>. For example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> pureFunction<span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">val</span> y <span class=\\\"token operator\\\">=</span> Math<span class=\\\"token punctuation\\\">.</span>rand<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n  \\n  x\\n<span class=\\\"token punctuation\\\">}</span>\\n\\npureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// always 2</span>\\n</code></pre>\\n      </div>\\n<p>And <span  class=\\\"underline\\\"> a function without side effects can be impure.</span> For example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">var</span> x <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">3</span>\\n\\n<span class=\\\"token keyword\\\">def</span> impureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span>\\n  x\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nimpureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// 3</span>\\n\\nx <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span>\\n\\nimpureFunction<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// 4</span>\\n</code></pre>\\n      </div>\\n<p>Functions with I/O operations still can be pure. And here we hit into monads. IO monads, to be precise. In Haskell side-effects don’t actually execute, they return values instead. In Scala it is not so, as Scala doesn’t support lazy evaluation by default. But we can emulate this behaviour ourself easily. We have to implement effectful function in such a way that it returns result, which can substitute the function itself.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token comment\\\">// IO monad</span>\\n<span class=\\\"token keyword\\\">trait</span> IO<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token keyword\\\">self</span> <span class=\\\"token keyword\\\">=></span>\\n\\n  <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> \\n\\n  <span class=\\\"token keyword\\\">def</span> map<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> B<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> \\n      IO<span class=\\\"token punctuation\\\">{</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">self</span><span class=\\\"token punctuation\\\">.</span>pure<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> pure<span class=\\\"token operator\\\">:</span> A\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">object</span> IO<span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token comment\\\">// f - is a function with effects</span>\\n  <span class=\\\"token keyword\\\">def</span> apply<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> A<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> \\n    <span class=\\\"token keyword\\\">new</span> IO<span class=\\\"token punctuation\\\">{</span>\\n    \\n      <span class=\\\"token comment\\\">// We do not actually execute effectful functions, </span>\\n      <span class=\\\"token comment\\\">// we compose them instead</span>\\n      <span class=\\\"token keyword\\\">override</span> <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>g<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n        IO<span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> g<span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>pure<span class=\\\"token punctuation\\\">}</span>\\n      \\n      <span class=\\\"token comment\\\">// Actual execution</span>\\n      <span class=\\\"token keyword\\\">override</span> <span class=\\\"token keyword\\\">def</span> pure<span class=\\\"token operator\\\">:</span> A <span class=\\\"token operator\\\">=</span> \\n        f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">// Now the funtion is referential transparent</span>\\n<span class=\\\"token keyword\\\">def</span> sum<span class=\\\"token punctuation\\\">(</span>a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">,</span> b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> IO<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Int</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  IO<span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> println<span class=\\\"token punctuation\\\">(</span>a <span class=\\\"token operator\\\">+</span> b<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> a <span class=\\\"token operator\\\">+</span> b<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\nsum<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>flatMap<span class=\\\"token punctuation\\\">(</span>a <span class=\\\"token keyword\\\">=></span> IO<span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">=></span> a <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// returns IO{() => println(3); 6}</span>\\n</code></pre>\\n      </div>\\n<p>It may seem, that all monads must be pure, as such is in Haskell. Be careful. Take into consideration that nothing is obvious in Scala. For example, Option is a monad and in Scala it is implemented something like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">sealed</span> <span class=\\\"token keyword\\\">abstract</span> <span class=\\\"token keyword\\\">class</span> Option<span class=\\\"token punctuation\\\">[</span><span class=\\\"token operator\\\">+</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">def</span> get<span class=\\\"token operator\\\">:</span> A\\n\\n  <span class=\\\"token keyword\\\">def</span> map<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> B<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Option<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>isEmpty<span class=\\\"token punctuation\\\">)</span> None <span class=\\\"token keyword\\\">else</span> Some<span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>get<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> flatMap<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>f<span class=\\\"token operator\\\">:</span> A <span class=\\\"token keyword\\\">=></span> Option<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Option<span class=\\\"token punctuation\\\">[</span>B<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>isEmpty<span class=\\\"token punctuation\\\">)</span> None <span class=\\\"token keyword\\\">else</span> f<span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>get<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">object</span> Option <span class=\\\"token punctuation\\\">{</span>\\n\\n  <span class=\\\"token keyword\\\">def</span> apply<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token operator\\\">:</span> A<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Option<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> \\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">==</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span> None <span class=\\\"token keyword\\\">else</span> Some<span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token punctuation\\\">)</span>\\n    \\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">case</span> <span class=\\\"token keyword\\\">class</span> Some<span class=\\\"token punctuation\\\">[</span><span class=\\\"token operator\\\">+</span>A<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">(</span>value<span class=\\\"token operator\\\">:</span> A<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">extends</span> Option<span class=\\\"token punctuation\\\">[</span>A<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">def</span> get <span class=\\\"token operator\\\">=</span> value\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">case</span> <span class=\\\"token keyword\\\">object</span> None <span class=\\\"token keyword\\\">extends</span> Option<span class=\\\"token punctuation\\\">[</span><span class=\\\"token builtin\\\">Nothing</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">def</span> get <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> NoSuchElementException<span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"None.get\\\"</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>See anything misleading? Look at flatMap attentively. It is not lazy, it executes. What does it mean? That we can’t safely implement effectful operations with it. And if you type Option(println(4)), 4 will be outputed to the console.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\">Option<span class=\\\"token punctuation\\\">(</span>println<span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// prints 4</span>\\n</code></pre>\\n      </div>\\n<p>Same with Future, List, Try and other monads in Scala. So, <span  class=\\\"underline\\\"> while monads in scala still abide monad laws, they can’t be considered pure. </span> So, functional programming is about pure functions and side effects, but monads are completely orthogonal concepts.</p>\\n<p>So, while monads are not about purity, they still can help us with the issues we listed in the beginning of the section.</p>\\n<ol>\\n<li>Functions can fail. - Option/Try/Either monad.</li>\\n<li>The value may be uncertain, when we are not sure if it exists at all. - Maybe monad.</li>\\n<li>The value can depend on a shared state. - State monad.</li>\\n<li>Functions can produce effects. - IO monad.</li>\\n<li>Functions can be asyncronous, when the value exists in the future. - Future/Promise monad.</li>\\n<li>The function result can vary for the same input. - Random monad.</li>\\n<li>The value may exists, but there are more than one of them. - List monad.</li>\\n</ol>\\n<p>!!!We have to compose and it is hard.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-c86e7.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 128.85496183206106%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAAGM0lEQVRIx4VVeXAb5RVfH3EosRNs67Rk3bva9a52V97VrdWuDkuWLVlO7NgktmTZieMjuDmMUxpIINAkJUAgwHBfw9DCcAyEmiYlDFeP6bTTGSZkuKbtDGVarjCdCRMCxtardn20HmD6/nk/ve+9n973jm+Rgwf3IccPTSKy3HtsWn380ETLzw+Or0d+QAAAibclFDy9KbNinxnY/F+nnQMbkXq1DXnt6Vsrr58Zctz+s12DJ24aJz4498r6D8/OYkmJ1R+58YbdxdE97WX3tXLM3snJaiQ2qMTfMTWmaDEqLv6jLM01tRXLWJa5r/591bvn/vXekZuOXTx03a7Pjxw+Cm5/4rPeoRHqfzMudKTosqp485e/WDQUR/J1V89MBWSsWremUtbvnzt79I3TJ6Gnux9ctA9+Oj0GwQC/sEGtA78gXbxqYnL20bvvzPVmu4o9XlYmRLCG2mrJy1cuknamnrxmoC8k4wfvenz34w8/WvJ64wtSfMu3KIqWNnXnFmJSvMQL8ZLaQkK0rQPyff2QyXTNuVr5l1C8ZXBVoXNS9ER7IAzBeHtvOpXbQbvwT1w0DzTtmacoZ2lzRxoGk5lSUEqCEM0vOLHA1w0NjfOhQOidFoYFs93xz5ggPOAjsLhC2NOdPYHarBAQhY+zmc7TdoseYiI3R6DN4LAbIOJnS+lEDFy8r+TnAiUWo8GFOkCnM35hK2vWTY9FSIJhUGtCbkrVxs7IW9ZmFWze1FaaGB8GzGG+wHGsTwx5H/K4ndDK4gt4C7bQqNUDQbPQXyjuD/q8J8kWDDAcvcCwjG3lui//6s46l9PyBaZrhCtzkW+HCz3lRrScLx/VyufJqPcpvfYKUKnq54wWC9jt1mOy3edGa1tw+5FwiO+Uf3Oks4q2myvlDNf6WOJ9n8MEdnXdHM85gaWdLy4N8VqCwJ7DUBOQFDFPtXJgstoGliZ8JSmHw1oha2qx4Qhy9MD0Y33pCBg1Gy4FfSRk20LPyvb7HpzVF4Z2ft4W9YDG6J23knHAaQGC0YQ84IiLpte4XHjlMrEoicvr9DU1vLX7S542AoEZSyyNQ8CH4wMDxbFtha0wmN8yv0HHQW29e67ZIQDjCz8jx9kJulKMRxWOcGApu21b01WyPjA92p+JuUCjagBDk/6iEOLD+SuzL7tIB2Ake8lGhC/WN5jnUUoEC0a+IcdcrrFXCNHo6mXvTSlLgkxs9K8TefJDk6HcSYvxeLl+NVKo9SNHeSxwmv1IrTH/AXOgwAdiEBaF38sxOoutopUPrSYsZKQVnAwwp0jMBCyD3SLvdbZd/Hsw4AaG4/ZSFN2/fbhwAcMp8ArSKdl/7eXrK7/zHHVyNDI6kFWuPZnPHW0TebisBukdH9v1Y8qdAhfLAUFYpbHJicZ0wvMnOePaBuY9FO+sl2P0JqHiO6QTI70K4dVTha7uTHSuPeklhoe2/9aO+cFkI2bls1RHn/GK+sYLGp0ZTA7pUxMa1C4S8qsJcz4GEcOcggM8rcmmxdF9eyf3by8WgXYx0GT2/6OmTqjrzm46pFJR4CQ4cDj5m5fGpuqHHuLyRggreP/01OmRQg60WhtodYFP3YxHZzPb3mlqxKDZQADFWJVOOAm0XEPn9xOObulTUjdVVdVPbMufj0TD0KzFwKRlZ5SONqheZWwU4KT/G62D8sg2SwtXGZaS3/+d8HGU0rGR/JaBrq4USFIc3Hjgba+qbp0yxHq1JxGULkWkLNBhUfmo8GK7cmV1U3w14ZtnTi4TV9x43b4/RiURfHzsr3ccvtuw7PP8c/drcvHIeZZkIdMzfFy22ZyeNQTTo5zrLcFFx9+cegG5Zs+Igs/++a7q3eNDfxGCMfCLuSdkmxBM1Mh6arw/2xEPgBNHS5wv9sm6avPKk6U1RVZnKEaCSv38ftKQTqb/1trqhqAY+fXSsVKK0eLm2VSbABpNA9gIF9jJ6Fcb1O4p3C39SKmx2b+c4Ulk5/hItYyv/cnU4eLQOKCMAEIi9brBYKpZKkWV18MWPTz9gLHZcA/Beu5t68m/1Iy1/s5GelOyT5OdXZzHM2dOITdcu0fJ4qF7bsvs2DHyCCskZ24+cbvywE7OHED+r6zBV+B/AClfC6u+Ve2lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"Transformer\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-fb8a0.png\\\"\\n        srcset=\\\"/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-1a291.png 148w,\\n/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-2bc4a.png 295w,\\n/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-fb8a0.png 590w,\\n/static/Optimus_Prime-c0111f504652673d8ec93a44bc170e5d-c86e7.png 655w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2 id=\\\"monad-transformers\\\"><a href=\\\"#monad-transformers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Monad Transformers</h2>\\n<p>Again, I won’t explain, what monad transformers are. You can find answers in a nice article <a href=\\\"https://blog.buildo.io/monad-transformers-for-the-working-programmer-aa7e981190e7\\\">Monad Transformers for the working programmer</a> by Gabriele Petronella.</p>\\n<p>The main inference from it is that <a href=\\\"http://blog.tmorris.net/posts/monads-do-not-compose/\\\">monads do not compose</a>. For their composition you need monad transformers. Example:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>User<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n<span class=\\\"token keyword\\\">def</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token operator\\\">:</span> User<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> findOrderByUserID<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">{</span>\\n    user    <span class=\\\"token keyword\\\">&lt;-</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span>\\n    order <span class=\\\"token keyword\\\">&lt;-</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">yield</span> order\\n  \\n</code></pre>\\n      </div>\\n<p>What if we don’t know if we have any orders?</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">def</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>User<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n<span class=\\\"token keyword\\\">def</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token operator\\\">:</span> User<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Option<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span><span class=\\\"token operator\\\">?</span>\\n\\n<span class=\\\"token keyword\\\">def</span> findOrderByUserID<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">{</span>\\n    user  <span class=\\\"token keyword\\\">&lt;-</span> getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// Future[User]</span>\\n    order <span class=\\\"token keyword\\\">&lt;-</span> getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// Future[Option[Order]]</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">yield</span> order\\n  \\n<span class=\\\"token comment\\\">// Type error. Nothing like we expected.</span>\\n</code></pre>\\n      </div>\\n<p>But we can use a monad transformer! </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-scalascala\\\"><code class=\\\"language-scalascala\\\"><span class=\\\"token keyword\\\">import</span> cats<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">.</span>OptionT<span class=\\\"token punctuation\\\">,</span> cats<span class=\\\"token punctuation\\\">.</span>std<span class=\\\"token punctuation\\\">.</span>future<span class=\\\"token punctuation\\\">.</span>_\\n<span class=\\\"token keyword\\\">def</span> findOrderByUserID<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">String</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Future<span class=\\\"token punctuation\\\">[</span>Option<span class=\\\"token punctuation\\\">[</span>Order<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span>\\n  <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">{</span>\\n    user    <span class=\\\"token keyword\\\">&lt;-</span> OptionT<span class=\\\"token punctuation\\\">(</span>getUserFromDB<span class=\\\"token punctuation\\\">(</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n    order <span class=\\\"token keyword\\\">&lt;-</span> OptionT<span class=\\\"token punctuation\\\">(</span>getOrderFromDB<span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">yield</span> order<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>value\\n</code></pre>\\n      </div>\\n<p>Great, now we are safe! Heh, not even close. When you enter the world of monad transformers, there is no way back. There exists a whole <a href=\\\"http://github.com/haskell/mtl/tree/master/Control/Monad\\\">“mtl” library</a> for them in Haskell. Haven’t seen anything like that in Scala though. And John A De Goes wrote a great article, which named <a href=\\\"http://degoes.net/articles/only-one-io\\\">There Can Be Only One…IO Monad</a>, leverage issues which occure, when we need to compose several monads together. </p>\\n<p>So, monad transformers are, literally, just monads wrapping other monads, which help us to compose monads. Nothing more.</p>\\n<p>!!! Problems with mtl: effects when combine monads, many monads.</p>\\n<p>Due to several problems, which accompany monad transformers, people introduced other approaches, such as Eff monad <a href=\\\"ttps://rubenpieters.github.io/monadtransformer/cats/eff/2017/01/27/monadtransformer-vs-effmonad-1.html\\\">“From Monad Transformers to the Eff Monad”</a>, Extensible effects <a href=\\\"https://www.cs.indiana.edu/~sabry/papers/exteff.pdf\\\">“Extensible Effects An Alternative to Monad Transformers”</a> by Oleg Kiselyov, Algebraic effects <a href=\\\"http://www.eff-lang.org/handlers-tutorial.pdf\\\">An Introduction to Algebraic Effects and Handlers</a>.</p>\\n<p>!!!When we compose, it is overhead, because we can’t use fusion.\\n!!! All of the problems can be solved in an imperative approach.\\nJavaScript leverage it’s single thread model to write in an imperative style</p>\\n<p>So, it is necessarily to write in monadic style? No. Can we write it in imperative way? Yes. </p>\\n<p>clumsy</p>\",\"shortExcerpt\":\"You’ve heard about them many times, but still not sure if you need…\",\"longExcerpt\":\"You’ve heard about them many times, but still not sure if you need them? Or maybe you use them every day and happy with it? In any case, you do not want to miss a chance to discuss them one more time. If it is so, let’s begin! Introduction First of all I’ll remind you how they look like. !!!Monad laws Misterious, aren’t they?.. No, they are not! You must be hit on them several times a day. When…\",\"frontmatter\":{\"date\":\"March 26, 2018\",\"path\":\"/monads\",\"title\":\"What are they, monads, angels or demons?\",\"tags\":[\"monads\",\"Scala\"],\"featuredImage\":{\"name\":\"angels\",\"childImageSharp\":{\"sizes\":{\"src\":\"/static/angels-2f707442fd003e1bc4d79ed77236a895-d447e.jpg\",\"srcSet\":\"/static/angels-2f707442fd003e1bc4d79ed77236a895-eed67.jpg 475w,\\n/static/angels-2f707442fd003e1bc4d79ed77236a895-f26f9.jpg 950w,\\n/static/angels-2f707442fd003e1bc4d79ed77236a895-d447e.jpg 1900w,\\n/static/angels-2f707442fd003e1bc4d79ed77236a895-3d50f.jpg 1920w\",\"base64\":\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAapMkaolf//EABoQAQACAwEAAAAAAAAAAAAAAAIBAwAREiH/2gAIAQEAAQUCrr4rcR2gMra0nKx+T//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAABESICECH/2gAIAQEABj8CqRkiqQ+kPX//xAAaEAEAAwADAAAAAAAAAAAAAAABABEhQVFh/9oACAEBAAE/IRyjm+xIGFXrLRTK6lQjn+JpJ//aAAwDAQACAAMAAAAQ7x//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8Qra//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QjI//xAAbEAEBAAMAAwAAAAAAAAAAAAABEQAhMVFhcf/aAAgBAQABPxBMH0+SxaAAEle3OWC5V94ShHXzJkSQGbMVpoNXP//Z\",\"aspectRatio\":1.5,\"sizes\":\"(max-width: 1900px) 100vw, 1900px\"}}}}}},\"pathContext\":{}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/monads.json\n// module id = 764\n// module chunks = 170358752846131"],"sourceRoot":""}